<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>清华集训 2017 题解 | OwenOwl</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Day 1 A. 生成树计数 考虑这棵树的 \(\mathrm{prufer}\) 序列，设 \(d_i\) 表示 \(i\) 在 \(\mathrm{prufer}\) 序列中出现的次数，则有 \(\sum d_i &#x3D; n - 2\)。 考虑一个序列 \(d\) 的贡献，是 \[ \begin{eqnarray} &amp;&amp;\frac{(n-2)!}{\prod d_i!}\">
<meta property="og:type" content="article">
<meta property="og:title" content="清华集训 2017 题解">
<meta property="og:url" content="https://owenowl.github.io/thujx/index.html">
<meta property="og:site_name" content="OwenOwl">
<meta property="og:description" content="Day 1 A. 生成树计数 考虑这棵树的 \(\mathrm{prufer}\) 序列，设 \(d_i\) 表示 \(i\) 在 \(\mathrm{prufer}\) 序列中出现的次数，则有 \(\sum d_i &#x3D; n - 2\)。 考虑一个序列 \(d\) 的贡献，是 \[ \begin{eqnarray} &amp;&amp;\frac{(n-2)!}{\prod d_i!}\">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2018-09-28T12:08:00.000Z">
<meta property="article:modified_time" content="2022-04-06T10:01:23.825Z">
<meta property="article:author" content="OwenOwl">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="OwenOwl" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">OwenOwl</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://owenowl.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-thujx" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/thujx/" class="article-date">
  <time datetime="2018-09-28T12:08:00.000Z" itemprop="datePublished">2018-09-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      清华集训 2017 题解
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="day-1-a.-生成树计数">Day 1 A. 生成树计数</h3>
<p>考虑这棵树的 <span class="math inline">\(\mathrm{prufer}\)</span> 序列，设 <span class="math inline">\(d_i\)</span> 表示 <span class="math inline">\(i\)</span> 在 <span class="math inline">\(\mathrm{prufer}\)</span> 序列中出现的次数，则有 <span class="math inline">\(\sum d_i = n - 2\)</span>。</p>
<p>考虑一个序列 <span class="math inline">\(d\)</span> 的贡献，是</p>
<p><span class="math display">\[
\begin{eqnarray}
&amp;&amp;\frac{(n-2)!}{\prod d_i!}\prod(d_i+1)^ma_i^{d_i+1}\sum (d_i+1)^m\\
&amp;=&amp;(n-2)!\prod a_i \sum_j \frac{1}{\prod d_i!} \prod a_i^{d_i}\prod_{i\ne j}(d_i+1)^m (d_j+1)^{2m}
\end{eqnarray}
\]</span></p>
<p>设后面这个 <span class="math inline">\(\sum\)</span> 关于 <span class="math inline">\(\sum d_i\)</span> 的生成函数是 <span class="math inline">\(F(x)\)</span>。再设</p>
<p><span class="math display">\[
\begin{eqnarray}
A(x)&amp;=&amp;\sum_{k} \frac{1}{k!} (k+1)^m x^k\\
B(x)&amp;=&amp;\sum_{k} \frac{1}{k!} (k+1)^{2m} x^k\\
\end{eqnarray}
\]</span></p>
<p>考虑枚举 <span class="math inline">\((d_i+1)^{2m}\)</span> 是哪一项被算的，则有</p>
<p><span class="math display">\[
\begin{eqnarray}
F(x)&amp;=&amp;\sum_i B(a_ix) \prod_{j\ne i} A(a_j x)\\
&amp;=&amp;\sum_i \frac{B(a_i x)}{A(a_i x)} \prod_i A(a_ix)\\
&amp;=&amp;\sum_i \frac{B(a_i x)}{A(a_i x)} \cdot \exp {\sum_i \ln A(a_ix)}\\
\end{eqnarray}
\]</span></p>
<p>求出 <span class="math inline">\(\frac{B(x)}{A(x)}\)</span> 和 <span class="math inline">\(\ln A(x)\)</span> 后，需要代入 <span class="math inline">\(a_ix\)</span> 并求和，于是还要对 $k $ 和 <span class="math inline">\([l_2,r_2](l_1&lt;l_2)\)</span>，如果前者包含后者，则后者的端点方向不同造成 <span class="math inline">\(1\)</span> 的代价；如果交叉，则 <span class="math inline">\(r_1\)</span> 和 <span class="math inline">\(l_2\)</span> 的方向相同造成 <span class="math inline">\(1\)</span> 的代价。直接枚举是 <span class="math inline">\(2^n\)</span> 的。</p>
<p>考虑按左端点排序以后，如果知道了前 <span class="math inline">\(i\)</span> 条线段的右端点方向，那么可以直接贪心出 <span class="math inline">\(i\)</span> 的左端点方向，因此是 <span class="math inline">\(2^{\frac{n}{2}}\)</span> 的，加上最优解剪枝即可过。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://paste.ubuntu.com/p/BpVrvCWgH7/</span><br></pre></td></tr></table></figure>
<h3 id="day-2-b.-小-y-和二叉树">Day 2 B. 小 Y 和二叉树</h3>
<p>先求出所有子树/子树外的最小的序列开头。</p>
<p>首先编号最小的度数 <span class="math inline">\(\le 2\)</span> 的点一定是序列开头，在树的最左下方。</p>
<p>如果固定了某个点作为当前子问题的序列开头，可以贪心右儿子和右父亲的放法，递归求解。如果固定了某个点作为当前子问题的根，可以贪心左右儿子的放法，递归求解。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://paste.ubuntu.com/p/wH4cJrTDqM/</span><br></pre></td></tr></table></figure>
<h3 id="day-2-c.-小-y-和恐怖的奴隶主">Day 2 C. 小 Y 和恐怖的奴隶主</h3>
<p>搜一下发现状态最多 <span class="math inline">\(165\)</span> 个，加上记答案一共 <span class="math inline">\(166\)</span> 维，先预处理出 <span class="math inline">\(2\)</span> 的次幂的答案，然后询问的时候用向量乘矩阵，复杂度就是 <span class="math inline">\(S^3\log n + T S^2 \log n\)</span>（<span class="math inline">\(S\)</span> 是维数）。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://paste.ubuntu.com/p/26SDwXckck/</span><br></pre></td></tr></table></figure>
<h3 id="day-3-a.-简单数据结构">Day 3 A. 简单数据结构</h3>
<p>这个题由于限制了每个数的插入次数最多为 <span class="math inline">\(10\)</span>，所以总复杂度很稳。</p>
<p>给每一个数开一个桶记录一下后面长为 <span class="math inline">\(d\)</span> 的答案数量，每次后端插删的时候更新约数，然后更新约数的约数。前端插删的时候枚举倍数暴力求一下这个数的答案就行了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://paste.ubuntu.com/p/CXXfVKw5JX/</span><br></pre></td></tr></table></figure>
<h3 id="day-3-b.-福若格斯">Day 3 B. 福若格斯</h3>
<p>首先手推一下每个数的 surreal number。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">*:    LL_RR LRL_R L_RLR</span><br><span class="line">up:   L_LRR</span><br><span class="line">down: LLR_R</span><br><span class="line">-1:   _RLLR _RLRL R_RLL</span><br><span class="line">+1:   LRRL_ RLRL_ RRL_L</span><br><span class="line">-1/2: LR_RL</span><br><span class="line">+1/2: RL_LR</span><br><span class="line">0:    Rest All</span><br></pre></td></tr></table></figure>
<p>这里规定 <span class="math inline">\(\{0|0\}=*\)</span> 表示先手胜，<span class="math inline">\(\{0|*\}=\uparrow\)</span>，<span class="math inline">\(\{*|0\}=\downarrow\)</span></p>
<p>然后一共有 <span class="math inline">\(0,\pm1,\pm \frac{1}{2},*,\uparrow,\downarrow\)</span> 一共 <span class="math inline">\(8\)</span> 种状态，其中前 <span class="math inline">\(5\)</span> 种可以求和，组合数算一下 <span class="math inline">\(&gt;0,=0,&lt;0\)</span> 的方案数分别有多少。</p>
<p>然后 <span class="math inline">\(\sum =0\)</span> 的状态会受到 <span class="math inline">\(*\)</span> 的奇偶性和 <span class="math inline">\(\uparrow,\downarrow\)</span> 哪个比较多影响。需要注意的是 <span class="math inline">\(*\)</span> 产生影响的话 <span class="math inline">\(\uparrow,\downarrow\)</span> 的个数差需要 <span class="math inline">\(&gt;1\)</span> 才会造成对应的影响。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://paste.ubuntu.com/p/bgxYJ6fgf5/</span><br></pre></td></tr></table></figure>
<h3 id="day-3-c.-避难所">Day 3 C. 避难所</h3>
<p>可以发现样例的构造方法是 <span class="math inline">\(\{2\times 3,2\times 3,2\times 3\} \Rightarrow \{3,3,3,2\times 2\times 2\}\)</span>。</p>
<p>于是可以构造最优解是 <span class="math inline">\(\{x\times y,x\times y,x\times y\}\)</span>，而贪心解是 <span class="math inline">\(\{x,x,x,y\times y\times y\}\)</span> 的东西。<span class="math inline">\(n\)</span> 足够大的时候大致取 <span class="math inline">\(y &lt; n^{1/3},x&gt;n^{1/2}\)</span> 即可。</p>
<p><span class="math inline">\(n\)</span> 小的话就暴力一下形如 <span class="math inline">\(\{a,b,b\}\)</span> 的答案是否可行即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://paste.ubuntu.com/p/YMKMxH4TYP/</span><br></pre></td></tr></table></figure>
<h3 id="day-4-a.-我的生命已如风中残烛">Day 4 A. 我的生命已如风中残烛</h3>
<p>首先考虑暴力，每次暴力找后继绕过去，如果绕的时候出现了绕着一个凸包转多圈的情况，相当于可以直接模掉这个凸包的长度。所以每次找循环节，线转一圈长度至少减半。</p>
<p>优化找后继，可以以每个点为中心预处理出极角序，再预处理从某个点过来的时候的第一个可行位置，转的时候拿个指针扫下去就行了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://paste.ubuntu.com/p/cbkGYxQw4Z/</span><br></pre></td></tr></table></figure>
<h3 id="day-4-b.-榕树之心">Day 4 B. 榕树之心</h3>
<p>DP 出一个子树内部互相消，可以消成至少几个点。那么就是把儿子中大小最大的挑出来，看其它儿子能不能把这个消没有。特判一下奇偶。</p>
<p>对 <span class="math inline">\(i\)</span> 的答案可以把 <span class="math inline">\(1\to i\)</span> 的路径缩成一个点求一下 DP 值。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://paste.ubuntu.com/p/S6rMpnPhTt/</span><br></pre></td></tr></table></figure>
<h3 id="day-4-c.-某位歌姬的故事">Day 4 C. 某位歌姬的故事</h3>
<p>首先离散化，求出每一段的最大值，判一下不合法。</p>
<p>然后对于同一个最大值，把这个最大值的区间全部抠出来，再把是这个最大值的限制全部抠出来，做一个 DP 就行了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://paste.ubuntu.com/p/dWTw4NmFFk/</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://owenowl.github.io/thujx/" data-id="cl1neuwpn0002qki6c24mdi9x" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/BZOJ3864/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">BZOJ3864 题解</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/thujx/">清华集训 2017 题解</a>
          </li>
        
          <li>
            <a href="/BZOJ3864/">BZOJ3864 题解</a>
          </li>
        
          <li>
            <a href="/poly2/">多项式题目“啖光之花”题解</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 OwenOwl<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>